<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Futuristic Typing Modal</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      background: #111;
      color: #0ff;
      font-family: 'Courier New', monospace;
    }

    #typingText {
      white-space: pre-wrap;
      font-size: 1rem;
    }

    .key {
      color: #ff2a7f;
      font-weight: bold;
    }

    .value {
      color: #00ffc3;
    }
  </style>
</head>
<body>

<!-- Modal Trigger -->
<button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#profileModal">Open Typing Modal</button>

<!-- Typing Sound -->
<audio id="typeSound" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_9ee5a39aa7.mp3" preload="auto"></audio>

<!-- Modal -->
<div class="modal fade" id="profileModal" tabindex="-1" aria-labelledby="modalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-scrollable">
    <div class="modal-content bg-dark text-light">
      <div class="modal-header">
        <h5 class="modal-title" id="modalLabel">System Profile</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body" id="modalBody">
        <pre id="typingText"></pre>
      </div>
    </div>
  </div>
</div>

<script>
  const typingSpeed = 40;
  const typingContainer = document.getElementById("typingText");
  const typeSound = document.getElementById("typeSound");
  const modalBody = document.getElementById("modalBody");
  const profileModal = document.getElementById('profileModal');

  let currentLine = 0;
  let currentChar = 0;
  let profileLines = [];
  let profileHTML = '';
  let isTyping = false;

  function resetTyping() {
    typeSound.pause();
    typeSound.currentTime = 0;
    typingContainer.textContent = "";
    currentLine = 0;
    currentChar = 0;
    isTyping = false;
  }

  function typeLine() {
    if (!isTyping) return;

    if (currentLine < profileLines.length) {
      const line = profileLines[currentLine];
      if (currentChar < line.length) {
        const char = line.charAt(currentChar);
        typingContainer.textContent += char;
        currentChar++;

        if (char !== " " && char !== "\n") {
          try {
            typeSound.currentTime = 0;
            typeSound.play();
          } catch (e) {}
        }

        modalBody.scrollTop = modalBody.scrollHeight;

        setTimeout(typeLine, typingSpeed);
      } else {
        typingContainer.textContent += "\n";
        currentLine++;
        currentChar = 0;
        setTimeout(typeLine, typingSpeed);
      }
    } else {
      typingContainer.innerHTML = profileHTML;
    }
  }

  async function getClientInfo() {
    const info = {};
    const ua = navigator.userAgent;

    info['Platform'] = navigator.platform;
    info['Browser'] = ua;
    info['Language'] = navigator.language;
    info['User Agent'] = ua;
    info['Online'] = navigator.onLine ? 'Yes' : 'No';

    if ("geolocation" in navigator) {
      info['Geolocation'] = await new Promise(resolve => {
        navigator.geolocation.getCurrentPosition(
          pos => resolve(`Lat: ${pos.coords.latitude}, Lon: ${pos.coords.longitude}`),
          err => resolve(`Error: ${err.message}`)
        );
      });
    }

    if (navigator.mediaDevices && navigator.mediaDevices.enumerateDevices) {
      const devices = await navigator.mediaDevices.enumerateDevices();
      const cams = devices.filter(d => d.kind === 'videoinput');
      const mics = devices.filter(d => d.kind === 'audioinput');
      const speakers = devices.filter(d => d.kind === 'audiooutput');

      info['Camera Devices'] = cams.length ? cams.map(d => d.label || 'Camera').join(', ') : 'None Detected';
      info['Microphone Devices'] = mics.length ? mics.map(d => d.label || 'Microphone').join(', ') : 'None Detected';
      info['Speaker Devices'] = speakers.length ? speakers.map(d => d.label || 'Speaker').join(', ') : 'None Detected';
    } else {
      info['Media Devices'] = 'Not Supported';
    }

    const plainText = Object.entries(info)
      .map(([key, value]) => `${key}: ${value}`)
      .join('\n');

    const htmlFormatted = Object.entries(info)
      .map(([key, value]) => `<span class="key">${key}:</span> <span class="value">${value}</span>`)
      .join('<br>');

    return { plainText, htmlFormatted };
  }

  profileModal.addEventListener('shown.bs.modal', async () => {
    resetTyping();
    const { plainText, htmlFormatted } = await getClientInfo();
    profileLines = plainText.split('\n');
    profileHTML = htmlFormatted;
    isTyping = true;
    typeLine();
  });

  profileModal.addEventListener('hidden.bs.modal', () => {
    resetTyping();
  });
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
